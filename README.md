## 如何防止外挂

### 外挂主要分两类：

1. 脱机式外挂：可以直接与服务器进行自由通讯，对通讯协议进行分析，解决封包的加密解密问题，是的封包合法化，让游戏服务器接收并处理。
2. 内挂式外挂：依赖游戏客户端，与游戏服务器进行通讯，通过反汇编手段进行分析，并修改客户端代码后实现开挂功能，直接调用游戏客户端的发包函数进行发包与收包。

### 反外挂要点：

1. 代码校验，检查diamagnetic是否被更改
2. 虚拟机保护
3. 驱动保护，对游戏的进程进行保护
4. 反调试，对调试过程进行干预，防止非法调试者进行调试
5. 防脱机式外挂：
   1. 封包通讯协议，对通信数据进行加密，避免数据欺骗
   2. 进行数据的合理性分析
6. 防内挂式外挂：
   1. 将封包加解密独立成一个动态链接库，使游戏主进程进行封包加解密
   2. 增加游戏时的线程，对代码进行校验
   3. 加解密函数加入反外挂线程检测，检测是否正常运行，如果不是正常运行，则切断游戏与服务器的连接

## 游戏中哪些数据存放服务端或客户端

客户端：主要是一些UI画面，如角色模型、动画、地图、特效等

服务端：主要存放用户的属性值，如仓库中的物质、用户游戏等级、经验值等

## 游戏的事件同步机制

​	当客户端发出一个操作指令时，客户端先不做该操作指令的响应，而是先发送给服务端，服务端收到操作指令之后对指令进行验证和执行指令，执行完之后服务端会计算出执行结果的广播范围，然后将指令的执行结果广播客户端，客户端收到指令执行结果之后在做出响应。

​	这个方法的优点是能保证各个客户端之间绝对的同步，缺点是当网络延迟比较大的时候，玩家的客户端的行为会变得比较不流畅

